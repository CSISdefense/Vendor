---
title: "Ad-hoc query processing"
author: "Greg Sanders"
date: "2022-10-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)




```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r MajCom}
MajCom<-NULL
path<-"..\\Data_Raw\\SAM\\DoD_Office_Info\\"
list.files("..")
files<-list.files(path) 
SourceFolderList<-c("PB2011","PB2012","PB2013","PB2014","PB2015","PB2016","PB2017","PB2018","PB2019","PB2020","PB2021","PB2022","PB2023")

for(decade in unique(SourceFolderList)){
  MilPersXLS <- XLConnect::loadWorkbook(file.path("..","data_raw",sfy,"m1.xlsx"))
  MilPersData <- XLConnect::readWorksheet(MilPersXLS, sheet = "Exhibit M-1", header=TRUE,startRow=2)
  MilPersData<-standardize_variable_names(MilPersData)
  
  colnames(MilPersData)[colnames(MilPersData)=="Account"]<-"AccountDSI"
  colnames(MilPersData)
  MilPersData$PByear<-as.numeric(substr(sfy,3,7))#Drop the FY from FY20XX
  MilPersData<-comptroller_melt(MilPersData)
  MilPersData<-ComptrollerVariableRename(MilPersData)
  MilPers<-rbind(MilPers,MilPersData)

}
write.csv(MilPers,file=file.path("..","data","semi_clean","MilPers","MilPers.csv"))

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
