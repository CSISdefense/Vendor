---
title: "Monoplies Data Exploration"
author: "Gregory Sanders"
date: "November 29, 2017"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(csis360)
library(dplyr)
load("data//defense_naics_vendor.Rdata")
annual_naics_summary<-subset(annual_naics_summary,Fiscal.Year>="2007-01-01")

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r sector_size}


ggplot(annual_naics_summary,
       aes(x=Action.Obligation))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(trans="log10",labels=scales::comma_format(),
                     breaks=c(1,1e2,1e3,1e4,1e5,1e6, 1e7,1e8,1e9, 1e10,1e11))+
  theme(axis.text.x = element_text(angle = 45,hjust=1))


ggplot(annual_naics_summary,
       aes(x=vendor_count))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(trans="log10",labels=scales::comma_format(),
                     breaks=c(1,4,8,12,20,50, 1e2,1e3,1e4,1e5,1e6, 1e7,1e8,1e9, 1e10,1e11))+
  theme(axis.text.x = element_text(angle = 45,hjust=1))


ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=vendor_count,
           color=Fiscal.Year))+geom_point()+
  scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(trans="log10",labels=scales::comma_format())
  
max(annual_naics_summary$Action.Obligation)

filter(annual_naics_summary,Action.Obligation==max(annual_naics_summary$Action.Obligation))


```

## Including Plots

You can also embed plots, for example:

```{r consolidation_measures}

ggplot(annual_naics_summary,
       aes(x=hh_index))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::comma_format())

#, echo=FALSE
ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=hh_index,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::comma_format())
  


ggplot(annual_naics_summary,
       aes(x=top4))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::percent_format())

ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=top4,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=top8))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=top8,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=top12))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::percent_format())



ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=top12,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())



ggplot(annual_naics_summary,
       aes(x=top20))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=top20,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())




ggplot(annual_naics_summary,
       aes(x=top50))+geom_histogram()+
  # scale_y_continuous(trans="log10",labels=scales::comma_format())+
  scale_x_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=Action.Obligation,
           y=top50,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(trans="log10",labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r CrossValidation}

ggplot(annual_naics_summary,
       aes(x=hh_index,
           y=top4,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=hh_index,
           y=top8,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())


ggplot(annual_naics_summary,
       aes(x=hh_index,
           y=top12,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())



ggplot(annual_naics_summary,
       aes(x=hh_index,
           y=top20,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())



ggplot(annual_naics_summary,
       aes(x=hh_index,
           y=top50,
           color=Fiscal.Year))+geom_point()+
  scale_x_continuous(labels=scales::comma_format())+
  scale_y_continuous(labels=scales::percent_format())

```