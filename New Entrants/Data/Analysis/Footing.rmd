---
title: "Footing"
author: "Greg Sanders"
date: "July 16, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(ggplot2)


if(file.exists("Cleaning Data/FPDS/FPDS_datapull_all_v3.Rda")){
  path<-"Cleaning Data/FPDS/"
} else if(file.exists("K:/2018-01 NPS New Entrants/Data/Data/Cleaning data/FPDS/FPDS_datapull_all_v3.Rda")){
  ##sam work computer
  path<-"K:/2018-01 NPS New Entrants/Data/Data/Cleaning data/FPDS/"
} else if(file.exists("/Users/samanthacohen/Desktop/Diig backup/New Entrants/R Data/FPDS_datapull_all_v3.Rda")){  
  ##sam laptop
  path<-"/Users/samanthacohen/Desktop/Diig backup/New Entrants/R Data/"
}
load(file = file.path(path,"FPDS_datapull_all_v2.Rda"))
load(file = file.path(path,"FPDS_datapull_all_v3.Rda"))
load(file = file.path(path,"FPDS_cleaned_unique_wtotalobligations.Rda"))

file.exists("Raw Data/FPDS/Vendor.SP_DunsnumberNewEntrants_all.txt")
dir.exists("Cleaning Data/")
dir.exists("Analysis")
file.exists("New Entrants.Rproj")
list.files(".")
FPDS_data <- read.delim(file.path("Raw Data/FPDS","Vendor.SP_DunsnumberNewEntrants_all.txt"), fill = TRUE, header=TRUE,  na.strings = c("", "NULL"))


```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

FPDS_data<-csis360::remove_bom(FPDS_data)
FPDS_data<-subset(FPDS_data,fiscal_year>=2000)
debug(csis360::deflate)
FPDS_data<-csis360::deflate(FPDS_data,money_var="obligatedAmount",
                            fy_var="fiscal_year")
FPDS_data<-FPDS_data %>%
  group_by(Dunsnumber) %>%
  dplyr::mutate(first_year=ifelse(min(fiscal_year)==fiscal_year,TRUE,FALSE) )


ggplot(data=FPDS_data,
             aes(x=fiscal_year,fill=first_year)
)+geom_bar(stat="count")


FPDS_summary<-FPDS_data %>%
  group_by(fiscal_year,first_year) %>%
  dplyr::summarize(obligatedAmount=sum(obligatedAmount,na.rm=TRUE))



ggplot(data=FPDS_summary,
             aes(x=fiscal_year,
                 y=obligatedAmount,
                 fill=first_year)
)+geom_bar(stat="identity")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
