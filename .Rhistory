rm(list = ls())
library(tidyverse)
library(csis360)
Path<-"C:\\Users\\gsand_000.ALPHONSE\\Documents\\Development\\R-scripts-and-data\\"
# Path<-"K:\\2007-01 PROFESSIONAL SERVICES\\R scripts and data\\"
source(paste(Path,"lookups.r",sep=""))
naics_original <- read_csv(unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.csv"),
col_names = TRUE,
na = c("","NA","NULL"))
naics_original <- read_csv(unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.csv"),
col_names = TRUE,
na = c("","NA","NULL"))
naics_original <- read_tsv(unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.txt"),
col_names = TRUE,
na = c("","NA","NULL"))
file<-unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.txt")
warnings()
naics_original <- read_tsv(file,
col_names = TRUE,
na = c("","NA","NULL"))
?read.csv
naics_original <- read.csv(file,
headers = TRUE,
na.strings = c("","NA","NULL"),
delim = "\t")
naics_original <- read.table(file,
header = TRUE,
na.strings = c("","NA","NULL"),
sep = "\t")
file<-unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.txt")
naics_original <- read.table(file,
header = TRUE,
na.strings = c("","NA","NULL"),
sep = "\t")
naics_original <- read.table(file,
header = TRUE,
na.strings = c("","NA","NULL"),
quote="\"",
sep = "\t")
file<-unz("Data\\Defense_Vendor_AllVendorHistoryNaics.zip",
filename="Defense_Vendor_AllVendorHistoryNaics.txt")
naics_original <- read.table(file,
header = TRUE,
na.strings = c("","NA","NULL"),
quote="\"",
sep = "\t")
naics_original<-apply_lookups(Path,naics_original)
save(naics_original,file="naics_original.Rdata")
names<-naics_original$AllContractor
names<-unique(naics_original$AllContractor)
names[names %in% c(
"MDA",
"Digital Globe",
"UTC",
"Rockwell Collins",
"Northrop",
"Orbital ATK",
"Boeing",
"Aurora"
)]
names[names %in% c(
"MDA",
"Digital Globe",
"UTC",
"Rockwell Collins",
"Northrop Grumman",
"Orbital ATK",
"Boeing",
"Aurora"
)]
names[ucase(names) %in% ucase(c(
"MDA",
"Digital Globe",
"UTC",
"Rockwell Collins",
"Northrop Grumman",
"Orbital ATK",
"Boeing",
"Aurora"
))]
?upper
names[toupper(names) %in% toupper(c(
"MDA",
"Digital Globe",
"UTC",
"Rockwell Collins",
"Northrop Grumman",
"Orbital ATK",
"Boeing",
"Aurora"
))]
defense_naics_vendor<-naics_original
rm(naics_original)
save(defense_naics_vendor,file="defense_naics_vendor.Rdata")
names[toupper(names) %in% toupper(c(
"MDA",  #Check
"DigitalGlobe", #Check
"UTC",
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital ATK",
"Boeing", #Check
"Aurora"
))]
colnames(defense_vendor)
colnames(defense_naics_vendor)
defense_vendor<-ddply(defense_vendor,
.(Fiscal.Year,
AllContractor,
ContractorDisplayName,
jointventure,
UnknownCompany,
WarningFlag,
Small
),
summarize,
Action.Obligation=sum(Action.Obligation),
numberOfActions=sum(numberOfActions),
Obligation.2016=sum(Obligation.2016)
)
defense_vendor<-ddply(defense_naics_vendor,
.(Fiscal.Year,
AllContractor,
ContractorDisplayName,
jointventure,
UnknownCompany,
WarningFlag,
Small
),
summarize,
Action.Obligation=sum(Action.Obligation),
numberOfActions=sum(numberOfActions),
Obligation.2016=sum(Obligation.2016)
)
defense_vendor<-ddply(defense_naics_vendor,
.(Fiscal.Year,
AllContractor
# ContractorDisplayName,
# jointventure,
# UnknownCompany,
# WarningFlag,
# Small
),
summarize,
Action.Obligation=sum(Action.Obligation),
numberOfActions=sum(numberOfActions),
Obligation.2016=sum(Obligation.2016)
)
names[toupper(names) %in% toupper(c(
"MDA",  #Check
"DigitalGlobe", #Check
"United Tech",
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital ATK",
"Boeing", #Check
"Aurora"
))]
names[toupper(names) %in% toupper(c(
"MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital ATK",
"Boeing", #Check
"Aurora Flight Sciences"
))]
names[toupper(names) %in% toupper(c(
"MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital Sciences",
"Boeing", #Check
"Aurora Flight Sciences" #Check but redownload
))]
sequestration <- filter(defense_naics_vendor,Fiscal.Year >= as.Date("2016-01-01"))
defense_naics_vendor_2016 <- filter(defense_naics_vendor,Fiscal.Year >= as.Date("2016-01-01"))
rm(sequestration)
defense_vendor_2016<-ddply(defense_vendor_2016,
.(Fiscal.Year,
AllContractor
# ContractorDisplayName,
# jointventure,
# UnknownCompany,
# WarningFlag,
# Small
),
summarize,
Action.Obligation=sum(Action.Obligation),
numberOfActions=sum(numberOfActions),
Obligation.2016=sum(Obligation.2016)
)
defense_vendor_2016<-ddply(defense_naics_vendor_2016,
.(Fiscal.Year,
AllContractor
# ContractorDisplayName,
# jointventure,
# UnknownCompany,
# WarningFlag,
# Small
),
summarize,
Action.Obligation=sum(Action.Obligation),
numberOfActions=sum(numberOfActions),
Obligation.2016=sum(Obligation.2016)
)
?rank
ddply(defense_vendor_2016,.(Fiscal.Year), transform, pos = rank(Action.Obligation,
ties.method ="min"))
defense_vendor_2016<-ddply(defense_vendor_2016,.(Fiscal.Year), transform, pos = rank(Action.Obligation,
ties.method ="min"))
View(subset(defense_vendor_2016,pos<=5))
(r1 <- rank(x1 <- c(3, 1, 4, 15, 92)))
x2 <- c(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)
names(x2) <- letters[1:11]
(r2 <- rank(x2)) # ties are averaged
defense_vendor_2016<-ddply(defense_vendor_2016,.(Fiscal.Year), transform, pos = rank(-Action.Obligation,
ties.method ="min"))
View(subset(defense_vendor_2016,pos<=5))
View(subset(defense_vendor_2016,pos<=5 |
AllContractor %in% c("MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital Sciences",
"Boeing", #Check
"Aurora Flight Sciences" #Check but redownload
)))
View(subset(defense_vendor_2016,pos<=5 |
toupper(AllContractor) %in% toupper(c("MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital Sciences",
"Boeing", #Check
"Aurora Flight Sciences" #Check but redownload
))))
View(subset(defense_vendor_2016,pos<=10 |
toupper(AllContractor) %in% toupper(c("MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital Sciences",
"Boeing", #Check
"Aurora Flight Sciences" #Check but redownload
))))
key_vendor_2016<-subset(defense_vendor_2016,pos<=10 |
toupper(AllContractor) %in% toupper(c("MDA",  #Check
"DigitalGlobe", #Check
"United Tech", #Check
"Rockwell Collins",  #Check
"Northrop Grumman",  #Check
"Orbital Sciences",
"Boeing", #Check
"Aurora Flight Sciences" #Check but redownload
)))
ggplot(key_vendor_2016,
aes(x=Fiscal.Year,
y=Obligation.2016,
color=AllContractor))+
geom_point()
key_vendor_2016$Sample<-"Original"
updated_vendor<-key_vendor_2016
key_vendor_2016$Sample<-"Original"
updated_vendor$Sample<-"Merged"
updated_vendor<-rbind(key_vendor_2016,updated_vendor)
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor))+
geom_point()
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor))+
geom_line()
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor))+
geom_line(group_by(AllContractor))
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor))+
geom_point()
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor))+
geom_line()
?geom_line
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor,
group=AllContractor))+
geom_line()
View(key_vendor_2016)
updated_vendor$VendorName<-updated_vendor$AllContractor
updated_vendor$VendorName[updated_vendor$VendorName=="DigitalGlobe"&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor<-rbind(key_vendor_2016,updated_vendor)
updated_vendor$VendorName<-updated_vendor$AllContractor
updated_vendor$VendorName[updated_vendor$VendorName=="DigitalGlobe"&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor$VendorName[updated_vendor$VendorName=="Rockwell Collins"&
updated_vendor$Sample=="Merged"]<-"United Tech"
updated_vendor$VendorName[updated_vendor$VendorName=="Orbital Sciences"&
updated_vendor$Sample=="Merged"]<-"Northrop Grumman"
updated_vendor$VendorName[updated_vendor$VendorName=="Aurora Flight Sciences"&
updated_vendor$Sample=="Merged"]<-"Boeing"
updated_vendor<-key_vendor_2016
key_vendor_2016$Sample<-"Original"
updated_vendor$Sample<-"Merged"
updated_vendor<-rbind(key_vendor_2016,updated_vendor)
updated_vendor$VendorName<-updated_vendor$AllContractor
updated_vendor$VendorName[updated_vendor$VendorName=="DigitalGlobe"&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor$VendorName[updated_vendor$VendorName=="Rockwell Collins"&
updated_vendor$Sample=="Merged"]<-"United Tech"
updated_vendor$VendorName[updated_vendor$VendorName=="Orbital Sciences"&
updated_vendor$Sample=="Merged"]<-"Northrop Grumman"
updated_vendor$VendorName[updated_vendor$VendorName=="Aurora Flight Sciences"&
updated_vendor$Sample=="Merged"]<-"Boeing"
updated_vendor$VendorName[updated_vendor$VendorName=="DigitalGlobe"&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor$VendorName[updated_vendor$VendorName=="Rockwell Collins"&
updated_vendor$Sample=="Merged"]<-"UNITED TECH"
updated_vendor$VendorName[updated_vendor$VendorName=="Orbital Sciences"&
updated_vendor$Sample=="Merged"]<-"NORTHROP GRUMMAN"
updated_vendor$VendorName[updated_vendor$VendorName=="Aurora Flight Sciences"&
updated_vendor$Sample=="Merged"]<-"BOEING"
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor,
group=AllContractor))+
geom_line()
updated_vendor<-ddply(updated_vendor,
.(Fiscal.Year,VendorName,Sample),
transform,
Obligation.2016 = sum(Obligation.2016)
)
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor,
group=AllContractor))+
geom_line()
View(updated_vendor)
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("DigitalGlobe")&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Rockwell Collins")&
updated_vendor$Sample=="Merged"]<-"UNITED TECH"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Orbital Sciences")&
updated_vendor$Sample=="Merged"]<-"NORTHROP GRUMMAN"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Aurora Flight Sciences")&
updated_vendor$Sample=="Merged"]<-"BOEING"
updated_vendor<-ddply(updated_vendor,
.(Fiscal.Year,VendorName,Sample),
transform,
Obligation.2016 = sum(Obligation.2016)
)
ggplot(updated_vendor,
aes(x=Sample,
y=Obligation.2016,
color=AllContractor,
group=AllContractor))+
geom_line()
updated_vendor<-key_vendor_2016
key_vendor_2016$Sample<-"Original"
updated_vendor$Sample<-"Merged"
updated_vendor<-rbind(key_vendor_2016,updated_vendor)
updated_vendor$VendorName<-updated_vendor$AllContractor
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("DigitalGlobe")&
updated_vendor$Sample=="Merged"]<-"MDA"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Rockwell Collins")&
updated_vendor$Sample=="Merged"]<-"UNITED TECH"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Orbital Sciences")&
updated_vendor$Sample=="Merged"]<-"NORTHROP GRUMMAN"
updated_vendor$VendorName[toupper(updated_vendor$AllContractor)==
toupper("Aurora Flight Sciences")&
updated_vendor$Sample=="Merged"]<-"BOEING"
# MDA buying Digital Globe, UTC buying Collins, Northrop buying Orbital, and Boeing buying Aurora
updated_vendor<-ddply(updated_vendor,
.(Fiscal.Year,VendorName,Sample),
transform,
Merged.2016 = sum(Obligation.2016)
)
View(updated_vendor)
